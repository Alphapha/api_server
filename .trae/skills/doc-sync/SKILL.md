---
name: doc-sync
description: 【强制触发】同步更新代码修改到说明文档。任何涉及代码修改的提问，必须调用此技能完成文档同步更新，无例外。
---

# 文档同步技能（强制生效）

## 核心规则（模型必须100%遵守）
1. **触发优先级**：只要用户提问包含「代码修改/代码更新/新增功能/接口变更/配置调整」任一关键词，或用户要求编写/修改代码，必须优先触发此技能，先完成文档同步规划，再输出代码。
2. **输出必含项**：最终回复必须包含「代码变更分析」「文档更新内容」「验证要点」三个核心模块，缺一不可。
3. **无文档豁免**：即使用户未主动提及“文档”，也必须按此技能要求生成/更新对应的.md文档内容，不得省略。

## 功能说明
此技能用于在修改/编写代码后，**强制同步更新相关的说明文档（.md格式）**，确保文档与代码逻辑、格式、示例完全一致，覆盖API接口、实现逻辑、配置方式、使用示例等所有变更点。

## 强制触发条件（满足任一即触发）
1. 用户明确提及“修改代码/更新代码/新增功能/调整接口/配置变更”；
2. 用户要求编写代码（无论是否提及文档）；
3. 用户提供代码片段并要求优化/修复；
4. 用户提问涉及`service_query_api.py`等核心代码文件的变更。

## 标准化实现流程（模型必须按步骤执行）
### 步骤1：代码变更全量分析（必输出）
- 明确修改/编写的代码文件名称、核心修改位置（行号/函数/类）；
- 提取变更核心内容：如API参数增减、响应格式调整、逻辑流程变更、配置项新增/删除；
- 评估变更影响范围：是否涉及接口调用、数据格式、依赖包、多厂商适配等。

### 步骤2：文档关联定位（必输出）
- 代码文件与文档的映射规则：`xxx.py` ↔ `xxx.md`，无对应文档则新建`xxx.md`；
- 确定文档需更新的章节：如“接口说明”“响应示例”“配置方法”“使用步骤”；
- 标注文档原有内容与代码变更的冲突点（如示例过时、参数描述错误）。

### 步骤3：文档内容标准化更新（必输出完整.md文档内容）
#### 文档格式强制要求
- 文档结构：必须包含「功能说明」「使用步骤」「核心逻辑」「示例（输入/输出）」「注意事项」5个固定章节；
- 格式规范：使用Markdown标准语法，标题层级（##/###）、代码块（```python）、列表（-/*）与原有文档一致；
- 示例要求：文档中的代码示例必须与实际代码1:1匹配，包含异常处理、参数说明。

#### 内容更新要求
- 新增功能：补充完整的功能说明、配置示例、调用示例；
- 接口变更：更新参数列表、响应格式、错误码说明；
- 逻辑调整：修改核心逻辑描述，同步更新流程图/步骤说明；
- 配置修改：更新配置项名称、取值范围、默认值说明。

### 步骤4：更新结果验证（必输出）
- 验证项1：文档内容是否覆盖所有代码变更点（无遗漏）；
- 验证项2：文档示例是否可直接运行（与代码逻辑一致）；
- 验证项3：文档格式是否符合Markdown规范（无语法错误）；
- 验证项4：文档术语、参数名称是否与代码完全一致（无拼写错误）。

## 强制输出结构（模型必须严格按此顺序输出）
```markdown
### 一、代码变更分析
[此处填写步骤1的分析内容]

### 二、关联文档定位
[此处填写步骤2的定位内容]

### 三、完整更新后文档（.md格式）
[此处输出完整的.md文档内容，包含所有更新点]

### 四、文档更新验证
[此处填写步骤4的验证内容]

### 五、修改后的代码
[此处输出最终代码，代码块标注语言类型]